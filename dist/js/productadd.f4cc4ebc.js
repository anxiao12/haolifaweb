(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["productadd"],{a1f7:function(t,a,i){},b487:function(t,a,i){"use strict";i("a1f7")},e0a2:function(t,a,i){"use strict";i.r(a);i("a450");var e=function(){var t=this,a=t._self._c;return a("div",{staticClass:"page-product-add abs scroll-y"},[a("div",{staticClass:"form-content"},[a("div",{staticClass:"title b f-18"},[t._v(t._s(t.form.id?"编辑":"新增")+"成品")]),a("div",{staticClass:"flex-v-center"},[a("input-box",{staticClass:"flex-item mr-10",attrs:{label:"成品名称"},model:{value:t.form.name,callback:function(a){t.$set(t.form,"name",a)},expression:"form.name"}}),a("input-box",{staticClass:"flex-item mr-10",attrs:{label:"成品编号（全局唯一）"},model:{value:t.form.productNo,callback:function(a){t.$set(t.form,"productNo",a)},expression:"form.productNo"}})],1),a("div",{staticClass:"flex-v-center"},[a("input-box",{staticClass:"flex-item mr-10",attrs:{label:"适配组件"},model:{value:t.form.fitComponent,callback:function(a){t.$set(t.form,"fitComponent",a)},expression:"form.fitComponent"}}),a("input-box",{staticClass:"flex-item mr-10",attrs:{label:"成品规格（如：DN65，DN80）"},model:{value:t.form.specifications,callback:function(a){t.$set(t.form,"specifications",a)},expression:"form.specifications"}})],1),a("div",{staticClass:"f-14 c-6 b",staticStyle:{margin:"10px 0 5px"}},[t._v("选择关联零件")]),t._l(t.form.productMaterialList,(function(i,e){return a("div",{key:i.id,staticClass:"flex-v-center"},[a("select-box",{staticStyle:{width:"25%"},attrs:{list:t.typeList,label:"零件分类"},on:{change:function(a){return t.getMaterialList(i.materialClassifyId,e)}},model:{value:i.materialClassifyId,callback:function(a){t.$set(i,"materialClassifyId",a)},expression:"item.materialClassifyId"}}),a("select-box",{staticClass:"flex-item ml-10",staticStyle:{width:"25%"},attrs:{list:t.materialList[i.materialClassifyId]||[],label:"零件图号"},model:{value:i.materialGraphNo,callback:function(a){t.$set(i,"materialGraphNo",a)},expression:"item.materialGraphNo"}}),a("select-box",{staticClass:"flex-item ml-10",staticStyle:{width:"25%"},attrs:{list:t.materialList[i.materialClassifyId]||[],label:"该零件可替换的图号"},model:{value:i.replaceMaterialGraphNo,callback:function(a){t.$set(i,"replaceMaterialGraphNo",a)},expression:"item.replaceMaterialGraphNo"}}),a("input-box",{staticClass:"flex-item ml-10",attrs:{type:"number",label:"零件数量"},model:{value:i.materialCount,callback:function(a){t.$set(i,"materialCount",a)},expression:"item.materialCount"}}),t.form.productMaterialList.length>1?a("icon-btn",{attrs:{small:""},on:{click:function(a){return t.removeProductMaterialList(e)}}},[t._v("close")]):t._e()],1)})),a("div",[a("icon-btn",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"添加关联零件",expression:"'添加关联零件'"}],attrs:{bg:"",small:""},on:{click:t.addProductMaterialList}},[t._v("add")])],1),a("div",{staticClass:"flex-v-center"},[a("input-box",{staticClass:"flex-item mr-10",attrs:{"multi-line":"",label:"备注"},model:{value:t.form.remark,callback:function(a){t.$set(t.form,"remark",a)},expression:"form.remark"}})],1),a("div",{staticClass:"flex-v-center",staticStyle:{margin:"20px 0"}},[a("btn",{staticClass:"mr-20",attrs:{big:"",disabled:!t.canSubmit},on:{click:t.submit}},[t._v("提交")]),a("btn",{staticClass:"mr-20",attrs:{big:"",flat:"",bg:""},on:{click:t.cancel}},[t._v("取消")])],1)],2)])},r=[],s=(i("1bc78"),{name:"page-product-add",data:function(){return{changeFlag:[],typeList:[],materialList:{},form:{id:"",name:"",productNo:"",specifications:"",fitComponent:"",remark:"",productMaterialList:[{materialClassifyId:"",materialCount:"",materialGraphNo:"",replaceMaterialGraphNo:""}]}}},computed:{canSubmit:function(){var t=this.form;return!!t.name&&!!t.productNo&&t.productMaterialList.every((function(t){return t.materialClassifyId&&t.materialCount&&t.materialGraphNo}))}},activated:function(){this.form={id:"",name:"",productNo:"",specifications:"",fitComponent:"",remark:"",productMaterialList:[{materialClassifyId:"",materialCount:"",materialGraphNo:"",replaceMaterialGraphNo:""}]};var t=this.$route.query.id;void 0!==t&&"product-edit"===this.$route.name&&this.getInfo(t),this.getTypeList()},created:function(){var t=this.$route.query.id;void 0!==t&&"product-edit"===this.$route.name&&this.getInfo(t),this.getTypeList()},methods:{addProductMaterialList:function(){this.form.productMaterialList.push({id:Math.random(),materialClassifyId:"",materialCount:"",materialGraphNo:"",replaceMaterialGraphNo:""})},removeProductMaterialList:function(t){this.form.productMaterialList.splice(t,1)},getMaterialList:function(t,a){var i=this;console.log(1),this.$http.get("/haolifa/material/getListByClassifyId/".concat(t)).then((function(e){i.$set(i.materialList,t,e.filter((function(t){return!t.isDelete})).map((function(t){return{value:t.graphNo,text:t.graphNo}}))),!i.changeFlag[a]&&i.$route.query.id||(i.form.productMaterialList[a].materialCount="",i.form.productMaterialList[a].materialGraphNo="",i.form.productMaterialList[a].replaceMaterialGraphNo=""),i.changeFlag.splice(a,1,!0)}))},getTypeList:function(){var t=this;this.$http.get("/haolifa/material/classify/list").then((function(a){t.typeList=a.filter((function(t){return!t.isDelete})).map((function(t){return{value:t.id,text:t.classifyName,list:[]}})),console.dir(a)}))},getInfo:function(t){var a=this;this.$http.get("/haolifa/product/getInfo/".concat(t)).then((function(t){for(var i in a.form)void 0!==a.form[i]&&(a.form[i]=t[i]);a.changeFlag=a.form.productMaterialList.map((function(t){return!1})),a.form.productMaterialList.forEach((function(t){a.getMaterialList(t.materialClassifyId)}))})).catch((function(t){a.$toast(t.msg||t.message)}))},cancel:function(){var t=this,a=this.form.id?"/product/edit":"/product/add";this.$confirm({title:"您确定要离开此页面吗？",text:"您的表单将不会保存",color:"red",btns:["取消","离开"],yes:function(){t.$store.commit("DELMENUTABS",a),t.$router.push("/product")}})},submit:function(){var t=this,a=this.form;this.loading=!0;var i=a.id?"put":"post",e=a.id?"/product/edit":"/product/add";this.$http[i]("/haolifa/product/".concat(a.id?"update":"save"),a).then((function(a){t.loading=!1,t.$store.commit("DELMENUTABS",e),t.$router.push("/product")})).catch((function(a){t.loading=!1,t.$toast(a.msg||a.message)}))}}}),o=s,l=(i("b487"),i("0b56")),n=Object(l["a"])(o,e,r,!1,null,null,null);a["default"]=n.exports}}]);
//# sourceMappingURL=productadd.f4cc4ebc.js.map