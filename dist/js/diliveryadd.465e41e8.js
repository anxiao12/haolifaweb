(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["diliveryadd"],{"11f7":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"apply-buy-add"},[s("div",{staticClass:"content"},[s("div",{staticClass:"title b f-18"},[t._v("新增送检单")]),s("div",{staticClass:"flex"},[s("date-picker",{staticClass:"flex-item",staticStyle:{"margin-right":"20px"},attrs:{hint:"必填",label:"到货时间"},model:{value:t.form.arrivalTime,callback:function(e){t.$set(t.form,"arrivalTime",e)},expression:"form.arrivalTime"}}),s("input-box",{staticClass:"flex-item",staticStyle:{"margin-right":"20px"},attrs:{label:"供应商名称"},model:{value:t.form.supplierName,callback:function(e){t.$set(t.form,"supplierName",e)},expression:"form.supplierName"}})],1),s("div",{staticClass:"flex"},[s("input-box",{staticClass:"flex-item mr-20",attrs:{label:"批次号"},model:{value:t.form.batchNumber,callback:function(e){t.$set(t.form,"batchNumber",e)},expression:"form.batchNumber"}}),s("input-box",{staticClass:"flex-item ml-20 mr-20",attrs:{label:"合同号"},model:{value:t.form.purchaseNo,callback:function(e){t.$set(t.form,"purchaseNo",e)},expression:"form.purchaseNo"}}),s("input-box",{staticClass:"flex-item ml-20 mr-20",attrs:{type:"number",label:"费用"},model:{value:t.form.freight,callback:function(e){t.$set(t.form,"freight",e)},expression:"form.freight"}})],1),s("div",{staticClass:"flex"},[s("upload-box",{staticStyle:{width:"50%"},attrs:{btnText:"质量保证书",fileList:t.fileList,onchange:t.uploadFile,onremove:t.removeFile,multiple:t.multiple}})],1),s("div",{staticClass:"b",staticStyle:{margin:"20px 0 10px"}},[t._v("送检列表")]),t._l(t.form.items,(function(e,a){return s("div",{key:a,staticClass:"card flex",staticStyle:{"margin-top":"0"}},[s("div",{staticClass:"flex-item"},[s("div",{staticClass:"flex"},[s("input-box",{staticClass:"flex-item mr-10",attrs:{label:"物料图号",hint:"必填"},model:{value:e.materialGraphNo,callback:function(s){t.$set(e,"materialGraphNo",s)},expression:"item.materialGraphNo"}}),s("input-box",{staticClass:"flex-item mr-10",attrs:{label:"物料名称",hint:"必填"},model:{value:e.materialName,callback:function(s){t.$set(e,"materialName",s)},expression:"item.materialName"}}),s("input-box",{staticClass:"mr-10",attrs:{type:"number",label:"送检数量",hint:"必填"},model:{value:e.deliveryNumber,callback:function(s){t.$set(e,"deliveryNumber",s)},expression:"item.deliveryNumber"}}),s("input-box",{staticClass:"mr-10",attrs:{type:"number",label:"采购数量",hint:"必填"},model:{value:e.purchaseNumber,callback:function(s){t.$set(e,"purchaseNumber",s)},expression:"item.purchaseNumber"}})],1),s("div",{staticClass:"flex"},[s("input-box",{staticClass:"flex-item mr-10",attrs:{label:"材质要求",hint:"选填"},model:{value:e.requirements,callback:function(s){t.$set(e,"requirements",s)},expression:"item.requirements"}}),s("input-box",{staticClass:"flex-item mr-10",attrs:{label:"规格",hint:"选填"},model:{value:e.specification,callback:function(s){t.$set(e,"specification",s)},expression:"item.specification"}}),s("input-box",{staticClass:"flex-item mr-10",attrs:{label:"单价"},model:{value:e.purchasePrice,callback:function(s){t.$set(e,"purchasePrice",s)},expression:"item.purchasePrice"}})],1),s("div",{staticClass:"flex"},[s("input-box",{staticClass:"flex-item mr-10",attrs:{label:"单位",hint:"选填"},model:{value:e.unit,callback:function(s){t.$set(e,"unit",s)},expression:"item.unit"}}),s("input-box",{staticClass:"flex-item",attrs:{label:"备注"},model:{value:e.remark,callback:function(s){t.$set(e,"remark",s)},expression:"item.remark"}})],1)]),t.form.items.length>1?s("div",[s("icon-btn",{attrs:{small:""},on:{click:function(e){return t.form.items.splice(a,1)}}},[t._v("close")])],1):t._e()])})),s("div",{staticClass:"card a flex-center",on:{click:function(e){return t.addItem()}}},[t._m(0)]),s("div",{staticClass:"flex mr-20"},[s("btn",{staticClass:"mr-20",attrs:{big:""},on:{click:function(e){return t.submit(1)}}},[t._v("保存")]),s("btn",{staticClass:"mr-20",attrs:{big:""},on:{click:function(e){return t.submit(2)}}},[t._v("保存并发起")]),s("btn",{attrs:{big:"",flat:""},on:{click:function(e){t.$store.commit("DELMENUTABS","/applyBuy-material/add"),t.$router.push("/applyBuy-material/addList")}}},[t._v("取消")])],1)],2)])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-v-center"},[s("i",{staticClass:"icon mr-10"},[t._v("add")]),s("span",[t._v("添加送检物料")])])}],r=(s("a450"),s("153b")),n=s("6864"),l=s.n(n),c={name:"apply-buy-add",data:function(){return{form:{arrivalTime:"",supplierName:"",batchNumber:"",purchaseNo:"",freight:0,status:1,items:[{deliveryNumber:"",materialGraphNo:"",materialName:"",purchaseNumber:"",remark:"",specification:"",unit:"",purchasePrice:0}],accessorys:[]},fileList:[],multiple:!0,resFileList:[]}},activated:function(){this.form={arrivalTime:"",supplierName:"",batchNumber:"",purchaseNo:"",freight:0,status:1,items:[{deliveryNumber:"",materialGraphNo:"",materialName:"",purchaseNumber:"",remark:"",specification:"",unit:"",purchasePrice:0}],accessorys:[]},this.fileList=[],this.multiple=!0,this.resFileList=[]},created:function(){var t=this.$route.query.id;void 0!==t&&"material-edit"===this.$route.name&&this.getInfo(t)},methods:{getInfo:function(t){var e=this;this.$http.get("/haolifa/material-inspect/info/".concat(t)).then((function(t){for(var s in t.inspect.arrivalTime=l()(t.inspect.arrivalTime).format("YYYY-MM-DD"),e.form)void 0!==e.form[s]&&(e.form[s]=t[s]),void 0==t[s]&&(e.form[s]=t.inspect[s])})).catch((function(t){e.$toast(t.msg||t.message)}))},addItem:function(){this.form.items.push({deliveryNumber:"",materialGraphNo:"",materialName:"",purchaseNumber:"",remark:"",specification:"",unit:"",purchasePrice:0})},uploadFile:function(t,e){var s=this;this.loading=!0,this.loadingMsg="正在上传",Object(r["a"])(t.source).then((function(e){s.$http.post("/haolifa/file/uploadFileBase64",{base64Source:e,fileName:t.name}).then((function(e){s.resFileList.push({fileName:t.name,fileUrl:e}),s.loading=!1})).catch((function(t){s.$toast(t.msg||t.message),s.loading=!1}))}))},removeFile:function(t,e){var s=this;return console.log(e.length),new Promise((function(t,a){s.resFileList.splice(e,1),console.log(s.resFileList),t()}))},submit:function(t){var e=this,s=this.form,a=(s.items,s.arrivalTime);a?(this.form.status=t,this.form.accessorys=this.resFileList,this.$http.post("/haolifa/material-inspect/save",this.form).then((function(t){e.loading=!1,e.$toast("提交成功"),e.$store.commit("DELMENUTABS","/applyBuy-material/add"),e.$router.push("/applyBuy-material/addList")})).catch((function(t){e.$toast(t.message||t.msg)}))):this.$toast("请填写到货时间")}}},o=c,u=(s("9046"),s("cba8")),p=Object(u["a"])(o,a,i,!1,null,null,null);e["default"]=p.exports},"13f5":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-material-list"},[s("i",{staticClass:"icon icon-abs",on:{click:t.flush}},[t._v("autorenew")]),s("div",{staticClass:"flex-v-center tool-bar"},[s("div",{staticClass:"flex-v-center search-bar",staticStyle:{"margin-right":"20px"}},[s("i",{staticClass:"icon f-20 c-8"},[t._v("search")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.inspectNo,expression:"filter.inspectNo"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"送检单号"},domProps:{value:t.filter.inspectNo},on:{change:function(e){return t.$refs.list.update(!0)},input:function(e){e.target.composing||t.$set(t.filter,"inspectNo",e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.purchaseOrderNo,expression:"filter.purchaseOrderNo"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"采购合同号"},domProps:{value:t.filter.purchaseOrderNo},on:{change:function(e){return t.$refs.list.update(!0)},input:function(e){e.target.composing||t.$set(t.filter,"purchaseOrderNo",e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.batchNumber,expression:"filter.batchNumber"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"批次号"},domProps:{value:t.filter.batchNumber},on:{change:function(e){return t.$refs.list.update(!0)},input:function(e){e.target.composing||t.$set(t.filter,"batchNumber",e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.supplierName,expression:"filter.supplierName"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"供应商"},domProps:{value:t.filter.supplierName},on:{change:function(e){return t.$refs.list.update(!0)},input:function(e){e.target.composing||t.$set(t.filter,"supplierName",e.target.value)}}})]),t._v("状态：\n        "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.status,expression:"filter.status"}],staticClass:"f-14",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"status",e.target.multiple?s:s[0])},function(e){return t.$refs.list.update(!0)}]}},[s("option",{attrs:{value:"0"}},[t._v("全部")]),s("option",{attrs:{value:"2"}},[t._v("质检中")]),s("option",{attrs:{value:"3"}},[t._v("质检完成")])]),s("div",{staticClass:"flex-item"}),s("router-link",{attrs:{to:"/applyBuy-material/add"}},[s("btn",{staticClass:"b",attrs:{flat:"",color:"#008eff"}},[t._v("创建送检单")])],1)],1),s("div",{staticClass:"flex-item scroll-y"},[s("data-list",{ref:"list",staticClass:"f-14",attrs:{"page-size":15,param:t.filter,url:"/haolifa/material-inspect/purchase-list/0",method:"get"},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item,i=e.index;return[s("td",{staticClass:"c-a"},[t._v(t._s(i))]),s("td",[t._v(t._s(a.inspectNo))]),s("td",[t._v(t._s(a.purchaseNo))]),s("td",[t._v(t._s(a.batchNumber))]),s("td",[t._v(t._s(a.totalCount))]),s("td",[t._v(t._s(a.qualifiedNumber))]),s("td",[t._v(t._s(a.arrivalTime))]),s("td",[t._v(t._s(a.supplierName))]),s("td",[t._v(t._s(a.freight))]),s("td",[t._v(t._s(a.createTime))]),s("td",[t._v(t._s(t.statusList[a.status].name))]),s("td",{staticClass:"t-right"},[s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.info(a)}}},[t._v("查看")]),s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.edit(a)}}},[t._v("编辑")]),1==a.status?s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.remove(a)}}},[t._v("删除")]):t._e(),1==a.status?s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.commit(a.id)}}},[t._v("发起报检")]):t._e()])]}}])},[s("tr",{attrs:{slot:"header"},slot:"header"},[s("th",{staticStyle:{width:"60px"}},[t._v("序号")]),s("th",[t._v("报检单号")]),s("th",[t._v("采购合同号")]),s("th",[t._v("批次号")]),s("th",[t._v("送检总数")]),s("th",[t._v("检验合格数")]),s("th",[t._v("到货日期")]),s("th",[t._v("供应商名称")]),s("th",[t._v("运费")]),s("th",[t._v("发起时间")]),s("th",[t._v("状态")]),s("th",{staticClass:"t-right",staticStyle:{width:"80px"}},[t._v("操作")])])])],1),t.layer?s("layer",{attrs:{title:"详情",width:"70%"}},[s("div",{staticClass:"layer-text",staticStyle:{"padding-bottom":"50px"}},[s("div",{staticClass:"form-content page-supplier-info"},[s("table",{staticClass:"f-14"},[s("tr",[s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}}),s("td",{staticStyle:{width:"10%"}})]),s("tr",[s("td",{staticClass:"b",attrs:{colspan:"11"}},[t._v("零件送检单")])]),s("tr",[s("th",{attrs:{colspan:"5"}},[t._v("送检单号："+t._s(t.inspect.inspectNo))]),s("td",{attrs:{colspan:"6"}},[t._v("发起日期："+t._s(t.inspect.createTime))])]),s("tr",[s("th",{attrs:{colspan:"5"}},[t._v("采购合同号："+t._s(t.inspect.purchaseNo))]),s("td",{attrs:{colspan:"6"}},[t._v("批次号："+t._s(t.inspect.batchNumber))])]),s("tr",[s("th",{attrs:{colspan:"5"}},[t._v("供应商："+t._s(t.inspect.supplierName))]),s("td",{attrs:{colspan:"6"}},[t._v("到货日期："+t._s(t.inspect.arrivalTime))])]),s("tr",[s("th",{attrs:{colspan:"11"}},[t._v("费用："+t._s(t.inspect.freight))])]),s("tr",[s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("序号")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("合同编号")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("物料名称")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("物料图号")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("规格")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("材质与标准要求")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("单位")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("采购数")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("送货数")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("不合格数量")]),s("td",{staticClass:"b",attrs:{colspan:"1"}},[t._v("备注")])]),t._l(t.items,(function(e,a){return s("tr",{key:a},[s("td",{attrs:{colspan:"1"}},[t._v(t._s(a+1))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.purchaseNo))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.materialName))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.materialGraphNo))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.specification))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.requirements))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.unit))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.purchaseNumber))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.deliveryNumber))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.unqualifiedNumber))]),s("td",{attrs:{colspan:"1"}},[t._v(t._s(e.remark))])])}))],2)]),t.resFileList.length?s("div",{staticClass:"mt-15 ml-20 mr-20",staticStyle:{"overflow-x":"auto"}},[s("div",{staticClass:"b f-18 flex-v-center ml-20",staticStyle:{"margin-bottom":"20px"}},[s("div",{staticClass:"flex-item",staticStyle:{"text-align":"left","line-height":"24px"}},[t._v("质量保证书")])]),s("div",{staticStyle:{"margin-left":"20px","margin-top":"5px"}},[s("table",{staticClass:"data-table"},[s("tr",{attrs:{slot:"header"},slot:"header"},[s("th",{staticStyle:{width:"60px"}},[t._v("序号")]),s("th",[t._v("文件名称")]),s("th",[t._v("下载地址")])]),t._l(t.resFileList,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a))]),s("td",[t._v(t._s(e.fileName))]),s("td",[s("a",{staticClass:"fixed-length",attrs:{href:e.fileUrl,title:e.fileUrl}},[t._v(t._s(e.fileUrl))])])])}))],2)])]):t._e(),t.inspectHistory.length?s("div",{staticClass:"mt-15 ml-20 mr-20",staticStyle:{"overflow-x":"auto"}},[s("div",{staticClass:"b f-18 flex-v-center ml-20",staticStyle:{"margin-bottom":"20px"}},[s("div",{staticClass:"flex-item",staticStyle:{"text-align":"center","line-height":"24px"}},[t._v("质检记录")])]),s("div",{staticClass:"flex-item scroll-y page-supplier-info",staticStyle:{"overflow-x":"auto"}},[s("table",{staticClass:"data-table"},[s("tr",{staticStyle:{display:"none"}},[s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"11%"}}),s("td",{staticStyle:{width:"12%"}})]),s("tr",[s("th",[t._v("质检单号")]),s("th",[t._v("类别")]),s("th",[t._v("物料名称")]),s("th",[t._v("物料图号")]),s("th",[t._v("检测数量")]),s("th",[t._v("合格数量")]),s("th",[t._v("不合格数量")]),s("th",[t._v("处理意见")]),s("th",[t._v("不合格现象描述")])]),t._l(t.inspectHistory,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(e.inspectNo))]),s("td",[t._v(t._s(1==e.type?"采购零件":"机加工零件"))]),s("td",[t._v(t._s(e.materialGraphName))]),s("td",[t._v(t._s(e.materialGraphNo))]),s("td",[t._v(t._s(e.testNumber))]),s("td",[t._v(t._s(e.qualifiedNumber))]),s("td",[t._v(t._s(e.unqualifiedNumber))]),s("td",[t._v(t._s(e.handlingSuggestion))]),s("td",[t._v(t._s(e.reasonArr?e.reasonArr.toString():""))])])}))],2)])]):t._e()]),s("div",{staticClass:"layer-btns"},[s("btn",{attrs:{flat:"",color:"#008eff"},on:{click:function(e){t.layer=!1}}},[t._v("关闭")])],1)]):t._e()],1)},i=[],r=s("9b68"),n={name:"page-material-list",components:{DataList:r["a"]},data:function(){return{filter:{type:0,status:0,inspectNo:"",supplierName:"",purchaseOrderNo:""},statusList:[{status:0,name:"全部"},{status:1,name:"未提交"},{status:2,name:"质检中"},{status:3,name:"质检完成"},{status:4,name:"入库中"},{status:5,name:"入库完成"}],layer:!1,inspect:{id:0,inspectNo:""},items:[],inspectHistory:[],resFileList:[]}},methods:{flush:function(){this.filter={type:0,status:0,inspectNo:"",supplierName:"",purchaseOrderNo:""},this.$refs.list.update(!0)},edit:function(t){this.$router.push("/applyBuy-material/edit?id=".concat(t.id))},remove:function(t){var e=this;this.$confirm({title:"删除确认",text:"您确定要删除以下送检单吗？<br><b>".concat(t.inspectNo,"</b>"),color:"red",btns:["取消","删除"],yes:function(){e.$http.get("/haolifa/material-inspect/delete/".concat(t.id)).then((function(t){e.$toast("删除成功"),e.$refs.list.update(!0)})).catch((function(t){e.$toast(t.msg||t.message)}))}})},getInfo:function(){var t=this;this.$http.get("/haolifa/material-inspect/info/".concat(this.inspect.id)).then((function(e){t.inspect=e.inspect,t.items=e.items,t.inspect.createTime=e.inspect.createTime.substring(0,10),t.inspect.arrivalTime=e.inspect.arrivalTime.substring(0,10),t.inspect.updateTime=e.inspect.updateTime.substring(0,10),""!=e.inspect.blueprints&&null!=e.inspect.blueprints&&(t.resFileList=JSON.parse(e.inspect.blueprints))})).catch((function(e){t.$toast(e.msg||e.message)}))},getInspectHistory:function(){var t=this;this.$http.get("/haolifa/material-inspect/history/list/".concat(this.inspect.inspectNo)).then((function(e){t.inspectHistory=e,t.inspectHistory.map((function(t){if(t.reasonList)return t.reasonArr=t.reasonList.map((function(t){if(t.number)return"数量:"+t.number+",原因:"+t.reason+";"}))})),console.log(t.inspectHistory)})).catch((function(e){t.$toast(e.msg||e.message)}))},commit:function(t){var e=this;this.$http.post("/haolifa/material-inspect/updateStatus/".concat(t,"?status=2")).then((function(t){e.$refs.list.update(!0)})).catch((function(t){e.$toast(t.msg||t.message)}))},info:function(t){this.layer=!0,this.inspect.id=t.id,this.inspect.inspectNo=t.inspectNo,this.resFileList=[],this.getInfo(),this.getInspectHistory()},close:function(){this.close=!1}}},l=n,c=(s("71b6"),s("cba8")),o=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=o.exports},"436e":function(t,e,s){},"4f9b":function(t,e,s){"use strict";s("d759")},"5d89":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-material-list"},[s("i",{staticClass:"icon icon-abs",on:{click:t.flush}},[t._v("autorenew")]),s("div",{staticClass:"flex-v-center tool-bar"},[s("div",{staticClass:"flex-v-center search-bar",staticStyle:{"margin-right":"20px"}},[s("i",{staticClass:"icon f-20 c-8"},[t._v("search")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.entrustNo,expression:"filter.entrustNo"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"机加工单号"},domProps:{value:t.filter.entrustNo},on:{change:function(e){return t.$refs.list.update(!0)},input:function(e){e.target.composing||t.$set(t.filter,"entrustNo",e.target.value)}}}),t._v("\n            状态：\n            "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.status,expression:"filter.status"}],staticClass:"f-14",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"status",e.target.multiple?s:s[0])},function(e){return t.$refs.list.update(!0)}]}},t._l(t.statusList,(function(e){return s("option",{key:e.id,domProps:{value:e.status}},[t._v(t._s(e.name))])})),0),s("i",{staticClass:"icon",staticStyle:{"margin-left":"-20px","pointer-events":"none"}},[t._v("arrow_drop_down")])]),s("div",{staticClass:"flex-item"}),s("router-link",{attrs:{to:"/applyBuy-machining/add"}},[s("btn",{staticClass:"b",attrs:{flat:"",color:"#008eff"}},[t._v("创建机加工单")])],1)],1),s("div",{staticClass:"flex-item scroll-y"},[s("data-list",{ref:"list",attrs:{"page-size":15,param:t.filter,url:"/haolifa/entrust/list",method:"post"},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item,i=e.index;return[s("td",{staticClass:"c-a"},[t._v(t._s(i))]),s("td",[t._v(t._s(a.entrustNo))]),s("td",[t._v(t._s(a.batchNumber))]),s("td",[t._v(t._s(a.purchaseNo))]),s("td",[t._v(t._s(t.workShopList[a.workshopType].name))]),s("td",[t._v(t._s("0"==a.workshopType?"暂无":a.supplierName))]),s("td",[t._v(t._s(a.materialGraphName))]),s("td",[t._v(t._s(a.materialGraphNo))]),s("td",[t._v(t._s(a.processedGraphNo))]),s("td",[t._v(t._s(t.busTypeList[a.busType]))]),s("td",[t._v(t._s(a.specifications))]),s("td",[t._v(t._s(a.model))]),s("td",[t._v(t._s(a.number))]),s("td",[t._v(t._s(a.createTime))]),s("td",[t._v(t._s(t.statusList[a.status+1].name))]),s("td",{staticClass:"t-right"},["2"!=a.workshopType||2!=a.status&&6!=a.status?t._e():s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.machining(a.entrustNo,4)}}},[t._v("处理完成")]),0==a.status||5==a.status?s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.remove(a)}}},[t._v("删除")]):t._e(),0==a.status?s("a",{staticClass:"blue",staticStyle:{"margin-right":"3px"},attrs:{href:"javascript:;"},on:{click:function(e){return t.initApprove(a.entrustNo,1)}}},[t._v("发起审批")]):t._e()])]}}])},[s("tr",{attrs:{slot:"header"},slot:"header"},[s("th",{staticStyle:{width:"60px"}},[t._v("序号")]),s("th",[t._v("机加工单号")]),s("th",[t._v("批次号")]),s("th",[t._v("采购合同号")]),s("th",[t._v("车间类型")]),s("th",[t._v("加工方")]),s("th",[t._v("物料名称")]),s("th",[t._v("物料图号")]),s("th",[t._v("加工后图号")]),s("th",[t._v("类别")]),s("th",[t._v("规格")]),s("th",[t._v("型号")]),s("th",[t._v("数量")]),s("th",[t._v("发起时间")]),s("th",[t._v("状态")]),s("th",{staticClass:"t-right",staticStyle:{width:"80px"}},[t._v("操作")])])])],1)])},i=[],r=s("9b68"),n={name:"page-machining-list",components:{DataList:r["a"]},data:function(){return{filter:{type:0,status:-1,entrustNo:""},statusList:[{status:-1,name:"全部"},{status:0,name:"未提交"},{status:1,name:"待审批"},{status:2,name:"待加工"},{status:3,name:"加工中"},{status:4,name:"处理完成"},{status:5,name:"审批不通过"},{status:6,name:"质检完成"}],workShopList:[{status:0,name:"暂无"},{status:1,name:"内部车间1"},{status:2,name:"外部"},{status:3,name:"内部车间2"}],busTypeList:["未选择","订单需求","生产库存"]}},methods:{flush:function(){this.filter={type:0,status:-1,entrustNo:""},this.$refs.list.update(!0)},machining:function(t,e){this.initApprove(t,e)},edit:function(t){this.$router.push("/applyBuy-machining/edit?entrustNo=".concat(t.entrustNo))},remove:function(t){var e=this;this.$confirm({title:"删除确认",text:"您确定要删除以下送检单吗？<br><b>".concat(t.entrustNo,"</b>"),color:"red",btns:["取消","删除"],yes:function(){e.$http.get("/haolifa/entrust/delete/".concat(t.entrustNo)).then((function(t){e.$toast("删除成功"),e.$refs.list.update(!0)})).catch((function(t){e.$toast(t.msg||t.message)}))}})},initApprove:function(t,e){var s=this;this.$http.get("/haolifa/entrust/updateStatus/".concat(t,"/").concat(e)).then((function(t){s.$refs.list.update(!0)})).catch((function(t){s.$toast(t.msg||t.message)}))}}},l=n,c=(s("4f9b"),s("cba8")),o=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=o.exports},"5ece":function(t,e,s){},"6f88":function(t,e,s){},"71b6":function(t,e,s){"use strict";s("6f88")},9046:function(t,e,s){"use strict";s("436e")},d4e2:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-invoice-list"},[s("i",{staticClass:"icon icon-abs",on:{click:t.flush}},[t._v("autorenew")]),s("div",{staticClass:"flex-v-center tool-bar"},[s("div",{staticClass:"flex-v-center search-bar",staticStyle:{"margin-right":"20px"}},[s("i",{staticClass:"icon f-20 c-8"},[t._v("search")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.orderNo,expression:"filter.orderNo"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"生产订单号"},domProps:{value:t.filter.orderNo},on:{change:function(e){t.$refs.list.update(!0),t.getPriceTotal()},input:function(e){e.target.composing||t.$set(t.filter,"orderNo",e.target.value)}}}),s("i",{staticClass:"icon f-20 c-8"},[t._v("search")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.constractParty,expression:"filter.constractParty"}],staticClass:"flex-item",staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"合同方"},domProps:{value:t.filter.constractParty},on:{change:function(e){t.$refs.list.update(!0),t.getPriceTotal()},input:function(e){e.target.composing||t.$set(t.filter,"constractParty",e.target.value)}}}),t._v("\n            发票状态：\n            "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.status,expression:"filter.status"}],staticClass:"f-14",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"status",e.target.multiple?s:s[0])},function(e){t.$refs.list.update(!0),t.getPriceTotal()}]}},t._l(t.statusList,(function(e){return s("option",{key:e.id,domProps:{value:e.status}},[t._v(t._s(e.name))])})),0),s("i",{staticClass:"icon",staticStyle:{"margin-left":"-20px","pointer-events":"none"}},[t._v("arrow_drop_down")])]),s("div",{staticClass:"flex-item",staticStyle:{"text-align":"right",color:"#0f95ff"}},[t._v("发票总金额（元）:"+t._s(t.priceTotal))]),s("router-link",{attrs:{to:"/jgzx-invoice/add"}},[s("btn",{staticClass:"b",attrs:{flat:"",color:"#008eff"}},[t._v("新增发票申请")])],1)],1),s("div",{staticClass:"flex-item scroll-y"},[s("data-list",{ref:"list",attrs:{"page-size":15,param:t.filter,url:"/haolifa/invoice/list/0",method:"post"},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item,i=e.index;return[s("td",{staticClass:"c-a"},[t._v(t._s(i))]),s("td",[t._v(t._s(a.orderNo))]),s("td",[t._v(t._s(a.constractParty))]),s("td",[t._v(t._s(a.orderAmount))]),s("td",[t._v(t._s(a.totalAmount))]),s("td",[t._v(t._s(t.statusArr[a.status].name))]),s("td",[t._v(t._s(a.remark))]),s("td",[t._v(t._s(a.createTime))]),s("td",[t._v(t._s(a.updateTime))]),s("td",{staticClass:"t-right"},[0==a.status?s("a",{staticClass:"blue",attrs:{href:"javascript:;"},on:{click:function(e){return t.add(a)}}},[t._v("开票申请 |")]):t._e(),0==a.status?s("a",{staticClass:"blue",attrs:{href:"javascript:;"},on:{click:function(e){return t.remove(a)}}},[t._v("删除")]):t._e()])]}}])},[s("tr",{attrs:{slot:"header"},slot:"header"},[s("th",{staticStyle:{width:"60px"}},[t._v("序号")]),s("th",[t._v("合同编号")]),s("th",[t._v("合同方")]),s("th",[t._v("合同金额")]),s("th",[t._v("开票金额")]),s("th",[t._v("状态")]),s("th",[t._v("备注")]),s("th",[t._v("创建时间")]),s("th",[t._v("更新时间")]),s("th",{staticClass:"t-right",staticStyle:{width:"80px"}},[t._v("操作")])])])],1)])},i=[],r=s("9b68"),n={name:"invoiceAdd-list",components:{DataList:r["a"]},data:function(){return{priceTotal:"",statusList:[{status:-1,name:"全部"},{status:0,name:"待开票"},{status:1,name:"已申请"},{status:2,name:"已开票"}],statusArr:[{status:0,name:"待开票"},{status:1,name:"已申请"},{status:2,name:"已开票"}],filter:{type:1,status:-1,orderNo:"",constractParty:""}}},mounted:function(){this.getPriceTotal()},methods:{flush:function(){this.filter={type:1,status:-1,orderNo:"",constractParty:""},this.$refs.list.update(!0),this.getPriceTotal()},edit:function(t){this.$router.push("/jgzx-invoice/edit?id=".concat(t.id))},getPriceTotal:function(){var t=this;this.$http.post("/haolifa/statistics/money/invoice/1",this.filter).then((function(e){t.priceTotal=e.totalAmount})).catch((function(e){t.$toast(e.msg||e.message)}))},remove:function(t){var e=this;this.$confirm({title:"删除确认",text:"您确定要删除以下发票吗？<br><b>".concat(t.invoiceNo,"</b>"),color:"red",btns:["取消","删除"],yes:function(){e.$http.get("/haolifa/invoice/delete/".concat(t.id)).then((function(t){e.$toast("删除成功"),e.$refs.list.update(!0)})).catch((function(t){e.$toast(t.msg||t.message)}))}})},add:function(t){var e=this,s={};s.id=t.id,s.invoiceNo=t.orderNo,s.status=1,this.$http.post("/haolifa/invoice/updateStatus",s).then((function(t){e.$toast("开票申请成功"),e.$refs.list.update(!0)})).catch((function(t){e.$toast(t.msg||t.message)}))}}},l=n,c=(s("fc08"),s("cba8")),o=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=o.exports},d759:function(t,e,s){},fc08:function(t,e,s){"use strict";s("5ece")}}]);
//# sourceMappingURL=diliveryadd.465e41e8.js.map